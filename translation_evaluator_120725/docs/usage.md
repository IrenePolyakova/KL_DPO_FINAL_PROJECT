# Руководство по использованию Translation Evaluator

## Запуск приложения

1. Активируйте виртуальное окружение:
```bash
conda activate translation-evaluator
```

2. Запустите приложение:
```bash
streamlit run app.py
```

## Подготовка файлов

### Исходный документ

Поддерживаются форматы:
- DOCX: один абзац = одно предложение
- CSV: с колонками для исходного текста и перевода

#### Формат CSV файла:
```csv
en,ru
"Source text","Reference translation"
```
или
```csv
ID,Исходный текст,Эталонный перевод
1,"Source text","Reference translation"
```

### Модель перевода

1. Подготовьте ZIP архив с моделью:
   - config.json
   - pytorch_model.bin/model.safetensors
   - tokenizer_config.json
   - vocab.json
   - source.spm (для Marian)
   - target.spm (для Marian)

2. Для Marian моделей убедитесь, что:
   - Присутствуют файлы .spm
   - Модель обучена для нужной языковой пары

## Использование приложения

1. Загрузка файлов:
   - Исходный документ (обязательно)
   - Дообученная модель (обязательно)
   - Эталонный перевод (опционально)
   - Переводы от других систем (опционально)

2. Настройка параметров:
   - Названия моделей
   - Количество дополнительных переводов

3. Запуск сравнения:
   - Нажмите "Сравнить переводы"
   - Дождитесь завершения обработки

4. Анализ результатов:
   - Таблица сравнения переводов
   - Графики метрик качества
   - Экспорт результатов

## Экспорт результатов

### CSV экспорт
Содержит:
- ID предложения
- Исходный текст
- Эталонный перевод
- Переводы от всех систем
- Метрики качества

### TMX экспорт
- Стандартный формат для CAT-систем
- Содержит пары исходный текст + перевод
- Отдельный файл для каждой системы

### PDF отчет
Включает:
- Общую информацию
- Таблицу сравнения
- Графики метрик
- Статистику

## Метрики качества

### BLEU
- Оценка точности перевода
- Диапазон: 0-100
- Выше = лучше

### chrF
- Оценка на уровне символов
- Диапазон: 0-100
- Выше = лучше

### TER
- Оценка количества правок
- Диапазон: 0-100
- Ниже = лучше

## Оптимизация производительности

### GPU режим
- batch_size=4
- n_jobs=1
- Требует CUDA

### CPU режим
- batch_size=32
- n_jobs=количество_потоков
- Для больших наборов данных

## Решение проблем

### Ошибки загрузки модели
1. Проверьте содержимое ZIP архива
2. Убедитесь в совместимости версий
3. Проверьте наличие всех файлов

### Ошибки перевода
1. Проверьте формат входных данных
2. Убедитесь в достаточности памяти
3. Уменьшите batch_size при необходимости

### Проблемы с метриками
1. Проверьте наличие эталонного перевода
2. Убедитесь в соответствии количества предложений
3. Проверьте наличие пустых строк 